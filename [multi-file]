# Frontend (Angular 19) - Guía de Desarrollo

## Requisitos
- Node.js 18+
- npm 9+

## Instalación y ejecución local
```bash
cd frontend
npm install

# Desarrollo (servidor de Angular)
npm start
# URL: http://localhost:4200
```

## Build
```bash
# Build de desarrollo
npm run build -- --configuration=development

# Build de producción
npm run build -- --configuration=production
```

## Notas técnicas
- Proyecto con Angular 19 (control flow `@if`, `@for`)
- Angular Material para UI
- Plotly.js con carga diferida (reduce el bundle inicial)
- Drag & Drop con Angular CDK

## Uso con Docker (Nginx)
El contenedor de frontend sirve los artefactos construidos con Nginx.
Para ver cambios de TypeScript/SCSS debes reconstruir la imagen:
```bash
# Desde la raíz del proyecto
# Reconstruir solo frontend y levantarlo
docker compose -f docker-compose.dev.yml up -d --build frontend

# Si persisten cachés, forzar sin caché
docker compose -f docker-compose.dev.yml build --no-cache frontend
docker compose -f docker-compose.dev.yml up -d frontend
```

## Estructura
```
src/app/
  core/          # servicios y modelos
  shared/        # componentes compartidos (grafico, filtro, drop-zone, variable-selector)
  features/      # dashboard, data-explorer
```

# Backend (Django 5) - Guía de Desarrollo

## Requisitos
- Python 3.11+
- PostgreSQL 15 (o usar Docker con el `docker-compose.dev.yml` del proyecto)

## Instalación local (sin Docker)
```bash
cd backend
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
# source venv/bin/activate

pip install -r requirements.txt
```

## Configuración
Variables de entorno recomendadas (en `.env` o variables del sistema):
- `SECRET_KEY` (obligatoria en producción)
- `DEBUG=true|false`
- `DATABASE_URL=postgres://user:pass@host:5432/dbname` (o configurar bloques `DATABASES` en `config/settings.py`)
- `ALLOWED_HOSTS=localhost,127.0.0.1`
- `CORS_ALLOWED_ORIGINS=http://localhost:4200`

## Migraciones y ejecución
```bash
# Crear/aplicar migraciones
python manage.py makemigrations
python manage.py migrate

# Crear superusuario interactivo (alternativa al comando no interactivo)
python manage.py createsuperuser

# Ejecutar servidor
python manage.py runserver
```

## Uso con Docker (compose v2)
```bash
# Desde la raíz del proyecto
# Levantar servicios
docker compose -f docker-compose.dev.yml up -d --build

# Ejecutar migraciones
docker compose -f docker-compose.dev.yml exec backend python manage.py migrate

# Crear superusuario de ejemplo (admin/admin123)
docker compose -f docker-compose.dev.yml exec backend \
  python manage.py shell -c "from django.contrib.auth import get_user_model; U=get_user_model(); u=U.objects.filter(username='admin').first() or U.objects.create_superuser('admin','admin@localhost','admin123'); print('Usuario listo:', u.username)"

# Ver logs
docker compose -f docker-compose.dev.yml logs -f backend
```

## Endpoints principales
Base URL: `http://localhost:8000`
- `GET  /api/v1/data/schema/resumen/` — esquema de datos
- `GET  /api/v1/data/estudiantes/estadisticas/` — estadísticas generales
- `POST /api/v1/data/estudiantes/consulta_dinamica/` — consulta dinámica
- `GET  /api/v1/analytics/desercion/` — análisis de deserción

## Notas de producción
- Establecer `DEBUG=false`
- Configurar `ALLOWED_HOSTS` y `CSRF_TRUSTED_ORIGINS`
- Usar un `SECRET_KEY` seguro
- Ejecutar `collectstatic` si se sirven estáticos desde Django

```bash
docker compose -f docker-compose.dev.yml exec backend \
  python manage.py collectstatic --noinput
```


